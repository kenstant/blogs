<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>接口耗时问题排查 | kenstant的博客</title>
    <meta name="description" content="kenstant的博客">
    <meta name="generator" content="VitePress v2.0.0-alpha.16">
    <link rel="preload stylesheet" href="/blogs/assets/style.B4PWJrCz.css" as="style">
    <link rel="preload stylesheet" href="/blogs/vp-icons.css" as="style">
    
    <script type="module" src="/blogs/assets/app.CM0tDhzG.js"></script>
    <link rel="preload" href="/blogs/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/blogs/assets/chunks/theme.DJQ3o67N.js">
    <link rel="modulepreload" href="/blogs/assets/chunks/framework.6-m_a-od.js">
    <link rel="modulepreload" href="/blogs/assets/tech-learning_practice_网络连接相关问题排查.md.lVJaX0Q0.lean.js">
    <link rel="icon" href="/blogs/icons/favicon.ico">
    <link rel="icon" type="image/png" sizes="16x16" href="/blogs/icons/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/blogs/icons/favicon-32x32.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/blogs/icons/apple-touch-icon.png">
    <link rel="manifest" href="/blogs/icons/site.webmanifest">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-8e410b79><!--[--><!--]--><!--[--><span tabindex="-1" data-v-be48d319></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-be48d319>Skip to content</a><!--]--><!----><header class="VPNav" data-v-8e410b79 data-v-46d25293><div class="VPNavBar top" data-v-46d25293 data-v-ddefa081><div class="wrapper" data-v-ddefa081><div class="container" data-v-ddefa081><div class="title" data-v-ddefa081><div class="VPNavBarTitle" data-v-ddefa081 data-v-4218a31a><a class="title" href="/blogs/" data-v-4218a31a><!--[--><!--]--><!----><span data-v-4218a31a>kenstant的博客</span><!--[--><!--]--></a></div></div><div class="content" data-v-ddefa081><div class="content-body" data-v-ddefa081><!--[--><!--]--><div class="VPNavBarSearch search" data-v-ddefa081 data-v-c6b1e06a><!--[--><button type="button" class="VPNavBarSearchButton" aria-label="Search" aria-keyshortcuts="/ control+k meta+k" data-v-c6b1e06a data-v-ef676460><span class="vpi-search" aria-hidden="true" data-v-ef676460></span><span class="text" data-v-ef676460>Search</span><span class="keys" aria-hidden="true" data-v-ef676460><kbd class="key-cmd" data-v-ef676460>⌘</kbd><kbd class="key-ctrl" data-v-ef676460>Ctrl</kbd><kbd data-v-ef676460>K</kbd></span></button><!----><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-ddefa081 data-v-b5c5c4dc><span id="main-nav-aria-label" class="visually-hidden" data-v-b5c5c4dc> Main Navigation </span><!--[--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-ddefa081 data-v-4c439896><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-4c439896 data-v-e7985c94 data-v-ad1bd3fa><span class="check" data-v-ad1bd3fa><span class="icon" data-v-ad1bd3fa><!--[--><span class="vpi-sun sun" data-v-e7985c94></span><span class="vpi-moon moon" data-v-e7985c94></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-ddefa081 data-v-61ed4e50 data-v-10b1d303><!--[--><a class="VPSocialLink no-icon" href="https://github.com/kenstant" aria-label="github" target="_blank" rel="me noopener" data-v-10b1d303 data-v-22b9c8b5><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-ddefa081 data-v-12e31893 data-v-db8b1fc3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-db8b1fc3><span class="vpi-more-horizontal icon" data-v-db8b1fc3></span></button><div class="menu" data-v-db8b1fc3><div class="VPMenu" data-v-db8b1fc3 data-v-70413b0b><!----><!--[--><!--[--><!----><div class="group" data-v-12e31893><div class="item appearance" data-v-12e31893><p class="label" data-v-12e31893>Appearance</p><div class="appearance-action" data-v-12e31893><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-12e31893 data-v-e7985c94 data-v-ad1bd3fa><span class="check" data-v-ad1bd3fa><span class="icon" data-v-ad1bd3fa><!--[--><span class="vpi-sun sun" data-v-e7985c94></span><span class="vpi-moon moon" data-v-e7985c94></span><!--]--></span></span></button></div></div></div><div class="group" data-v-12e31893><div class="item social-links" data-v-12e31893><div class="VPSocialLinks social-links-list" data-v-12e31893 data-v-10b1d303><!--[--><a class="VPSocialLink no-icon" href="https://github.com/kenstant" aria-label="github" target="_blank" rel="me noopener" data-v-10b1d303 data-v-22b9c8b5><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-ddefa081 data-v-0068b816><span class="container" data-v-0068b816><span class="top" data-v-0068b816></span><span class="middle" data-v-0068b816></span><span class="bottom" data-v-0068b816></span></span></button></div></div></div></div><div class="divider" data-v-ddefa081><div class="divider-line" data-v-ddefa081></div></div></div><!----></header><div class="VPLocalNav empty fixed" data-v-8e410b79 data-v-ce6f96dc><div class="container" data-v-ce6f96dc><!----><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-ce6f96dc data-v-9b0a0265><button data-v-9b0a0265>返回顶部</button><!----></div></div></div><!----><div class="VPContent" id="VPContent" data-v-8e410b79 data-v-1321b454><div class="VPDoc has-aside" data-v-1321b454 data-v-d30c2b42><!--[--><!--]--><div class="container" data-v-d30c2b42><div class="aside" data-v-d30c2b42><div class="aside-curtain" data-v-d30c2b42></div><div class="aside-container" data-v-d30c2b42><div class="aside-content" data-v-d30c2b42><div class="VPDocAside" data-v-d30c2b42 data-v-9a6af9f7><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-9a6af9f7 data-v-b72904b0><div class="content" data-v-b72904b0><div class="outline-marker" data-v-b72904b0></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-b72904b0>On this page</div><ul class="VPDocOutlineItem root" data-v-b72904b0 data-v-835de44b><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-9a6af9f7></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-d30c2b42><div class="content-container" data-v-d30c2b42><!--[--><!--]--><main class="main" data-v-d30c2b42><div style="position:relative;" class="vp-doc _blogs_tech-learning_practice_%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5 external-link-icon-enabled" data-v-d30c2b42><div><br><h2 id="网络连接相关问题排查" tabindex="-1">网络连接相关问题排查 <a class="header-anchor" href="#网络连接相关问题排查" aria-label="Permalink to “网络连接相关问题排查”">​</a></h2><h3 id="_1-使用netstat命令" tabindex="-1">1. 使用<code>netstat</code>命令 <a class="header-anchor" href="#_1-使用netstat命令" aria-label="Permalink to “1. 使用netstat命令”">​</a></h3><h4 id="_1-1-参数解释" tabindex="-1">1.1 参数解释 <a class="header-anchor" href="#_1-1-参数解释" aria-label="Permalink to “1.1 参数解释”">​</a></h4><table tabindex="0"><thead><tr><th>参数</th><th>解释</th></tr></thead><tbody><tr><td><code>-a</code></td><td>显示所有连接和监听端口</td></tr><tr><td><code>-t</code></td><td>仅显示<code>TCP</code>连接</td></tr><tr><td><code>-u</code></td><td>仅显示<code>UDP</code>连接</td></tr><tr><td><code>-n</code></td><td>以数字形式显示地址和端口号，而不是尝试解析名称</td></tr><tr><td><code>-l</code></td><td>仅显示在监听状态的套接字</td></tr><tr><td><code>-p</code></td><td>显示使用该链接的进程id（需要root权限）</td></tr><tr><td><code>-r</code></td><td>显示路由表</td></tr><tr><td><code>-i</code></td><td>显示网络接口列表及其统计信息</td></tr></tbody></table><h4 id="_1-2-结果列解释" tabindex="-1">1.2 结果列解释 <a class="header-anchor" href="#_1-2-结果列解释" aria-label="Permalink to “1.2 结果列解释”">​</a></h4><table tabindex="0"><thead><tr><th>列名</th><th>解释</th></tr></thead><tbody><tr><td><code>proto</code></td><td>协议类型（<code>TCP</code>/<code>UDP</code>)</td></tr><tr><td><code>Recv-Q</code></td><td>接收队列中的字节数</td></tr><tr><td><code>Send-Q</code></td><td>发送队列中的字节数</td></tr><tr><td><code>Local Address</code></td><td>本地IP地址和端口</td></tr><tr><td><code>Foreign Address</code></td><td>远程IP地址和端口</td></tr><tr><td><code>State</code></td><td>连接状态（如<code>LISTEN</code>,<code>ESTABLISHED</code>,<code>TIME_WAIT</code>等）</td></tr><tr><td><code>PID/Program name</code></td><td>进程id或进程名称</td></tr></tbody></table><h4 id="_1-3-案例解析" tabindex="-1">1.3 案例解析 <a class="header-anchor" href="#_1-3-案例解析" aria-label="Permalink to “1.3 案例解析”">​</a></h4><h5 id="_1-3-1-找到当前服务器中连接数使用最多的进程" tabindex="-1">1.3.1 找到当前服务器中连接数使用最多的进程 <a class="header-anchor" href="#_1-3-1-找到当前服务器中连接数使用最多的进程" aria-label="Permalink to “1.3.1 找到当前服务器中连接数使用最多的进程”">​</a></h5><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">netstat</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -tunp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> awk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;{print $7}&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> cut</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sort</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> uniq</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sort</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -nr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> head</span></span></code></pre></div><ul><li><p>命令解释</p><ul><li><code>netstat -tunp</code>: 显示 <code>TCP</code> 和 <code>UDP</code>连接，以数字形式显示地址和端口，并显示进程ID。</li><li><code>awk &#39;{print $7}&#39;</code>：提取上个命令输出中的第7列，通常是<code>PID/Program name</code>列。</li><li><code>cut -d&#39;/&#39; -f1&#39;</code>：使用<code>/</code>作为分隔符，从中提取第一个片段，即<code>pid</code>。</li><li><code>sort</code>：对进程ID进程排序。</li><li><code>uniq -c</code>：统计每个进程ID出现的次数。</li><li><code>sort -nr</code>：按照连接数进行降序排序。</li><li><code>head</code>：显示连接数最多的前10个进程。</li></ul></li><li><p>结果</p></li></ul><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@my-host-name admin]# netstat -tunp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> awk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;{print $7}&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> cut</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sort</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> uniq</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sort</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -nr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> head</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   2198</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> -</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    145</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1452252</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      4</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2136313</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Address</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 691</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2510786</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1675446</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1003284</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      1</span></span></code></pre></div><ul><li>结果解析 <ul><li>连接数使用第二多的进程id已经出来了。</li><li>但是连接数使用最多的进程id没有打印出来，可以看第2个案例了</li></ul></li></ul><h5 id="_1-3-2-查看当前服务器中连接状态的统计" tabindex="-1">1.3.2 查看当前服务器中连接状态的统计 <a class="header-anchor" href="#_1-3-2-查看当前服务器中连接状态的统计" aria-label="Permalink to “1.3.2 查看当前服务器中连接状态的统计”">​</a></h5><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">netstat</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -tunp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> awk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;{print $6}&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sort</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> uniq</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sort</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -nr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> head</span></span></code></pre></div><ul><li>参数解析不再赘述，参考案例1。</li><li>结果</li></ul><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@my-host-name admin]# netstat -tunp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> awk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;{print $6}&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sort</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> uniq</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sort</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -nr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> head</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   2323</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TIME_WAIT</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    145</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ESTABLISHED</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Foreign</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      1</span></span></code></pre></div><ul><li>结果解析 <ul><li>有<code>2323</code>个连接处于<code>TIME_WAIT</code>状态，这在<code>TCP</code>协议中，是主动发起关闭的一方才会有的状态。</li><li>有<code>145</code>个连接处于<code>ESTABLISHED</code>状态，和案例1中进程号<code>1452252</code>对应的连接数差不多，应该是这个进程建立了这么多连接。确认方法参考案例3。</li><li>接下来我们要找出是哪个进程导致了这么多<code>TIME_WAIT</code>状态产生，参考案例3。</li></ul></li></ul><h5 id="_1-3-3-统计产生time-wait状态连接的本地端口号前3名。" tabindex="-1">1.3.3 统计产生<code>TIME_WAIT</code>状态连接的本地端口号前3名。 <a class="header-anchor" href="#_1-3-3-统计产生time-wait状态连接的本地端口号前3名。" aria-label="Permalink to “1.3.3 统计产生TIME_WAIT状态连接的本地端口号前3名。”">​</a></h5><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">netstat</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -tunp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TIME_WAIT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> awk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;{print $4}&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> cut</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;:&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sort</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> uniq</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sort</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -nr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> head</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span></span></code></pre></div><ul><li><p>参数解析</p><ul><li><code>sort -nr</code>：降序排序</li><li><code>head -n 3</code>：展示3条数据，结合前面就是展示处于 <code>TIME_WAIT</code>状态最多的3个端口号。</li></ul></li><li><p>结果</p></li></ul><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@my-host-name admin]# netstat -tunp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TIME_WAIT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> awk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;{print $4}&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> cut</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;:&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sort</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> uniq</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sort</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -nr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> head</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   2236</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8090</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 60446</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 59712</span></span></code></pre></div><ul><li>结果解析 <ul><li>可以看出，是<code>8090</code>端口产生了这么多的<code>TIME_WAIT</code>。</li><li>找出监听<code>8090</code>端口的进程，参考案例4。</li></ul></li></ul><h5 id="_1-3-4-找出端口对应的进程id" tabindex="-1">1.3.4 找出端口对应的进程id <a class="header-anchor" href="#_1-3-4-找出端口对应的进程id" aria-label="Permalink to “1.3.4 找出端口对应的进程id”">​</a></h5><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">netstat</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -tunlp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8090</span></span></code></pre></div><ul><li><p>参数解析</p><ul><li><code>-l</code>：仅显示处于监听状态的<code>socket</code>。如果不加<code>-l</code>参数会打印出和<code>8090</code>端口相关的所有连接，但是我们只想知道是哪个进程在监听<code>8090</code>端口，所以要加上<code>-l</code>参数。</li></ul></li><li><p>结果</p></li></ul><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@my-host-name admin]# netstat -tunlp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8090</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tcp6</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">       0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> :::8090</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                 :::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                    LISTEN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      1452252/java</span></span></code></pre></div><ul><li>结果解析 <ul><li>是一个<code>Java进程</code>，进程ID是<code>1452252</code>，可以通过<code>ps</code>命令找到是哪个具体的进程了。</li></ul></li></ul></div></div></main><footer class="VPDocFooter" data-v-d30c2b42 data-v-6d6b3e6e><!--[--><!--]--><div class="edit-info" data-v-6d6b3e6e><!----><div class="last-updated" data-v-6d6b3e6e><p class="VPLastUpdated" data-v-6d6b3e6e data-v-17f12ee2>上次更新时间: <time datetime="2025-11-30T14:36:26.000Z" data-v-17f12ee2></time></p></div></div><!----></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter" data-v-8e410b79 data-v-e121ba62><div class="container" data-v-e121ba62><p class="message" data-v-e121ba62>我与我周旋久，宁做我</p><p class="copyright" data-v-e121ba62>Copyright © 2025</p></div></footer><!--[--><div class="back-button-floating"><div class="floating-ball"><span class="back-icon">←</span><span class="back-text">返回</span></div></div><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"drafts_index.md\":\"Ck7PHTEk\",\"english_index.md\":\"BgnHkeOC\",\"english_常用短语.md\":\"CUFSO8t_\",\"english_语法.md\":\"C7mPbqeq\",\"index.md\":\"SQ4xG-we\",\"investment_index.md\":\"DMgqkC_G\",\"investment_经验教训.md\":\"CJkGG2hc\",\"investment_预案_操作预案.md\":\"Bz_O_G8W\",\"reading-notes_index.md\":\"DqGKQVnO\",\"reading-notes_《大话设计模式》_01-uml.md\":\"YM0DaF-L\",\"reading-notes_《大话设计模式》_02-简单工厂模式.md\":\"CqxM45id\",\"reading-notes_《大话设计模式》_03-策略模式.md\":\"WdfH7nnC\",\"reading-notes_《大话设计模式》_index.md\":\"1uwTb12m\",\"tech-learning_build-blog_index.md\":\"Bi1khc3y\",\"tech-learning_build-blog_使用vuepress搭建博客.md\":\"C3t0pO4o\",\"tech-learning_build-blog_使用vuepress默认主题.md\":\"eA7cIEo2\",\"tech-learning_build-blog_将博客部署到github pages.md\":\"CMUog2WQ\",\"tech-learning_index.md\":\"NqJRs96t\",\"tech-learning_java_index.md\":\"CnOdj_Y3\",\"tech-learning_java_jdk21-virtual-threads-intro.md\":\"CcfjoIWo\",\"tech-learning_java_maven-wrapper.md\":\"Du8RhHd9\",\"tech-learning_practice_index.md\":\"0Ysv7X8O\",\"tech-learning_practice_redis批量删除固定前缀key.md\":\"DlLRQZRF\",\"tech-learning_practice_具体问题列表.md\":\"BcdxE0mS\",\"tech-learning_practice_接口耗时问题排查.md\":\"BGPVcYWR\",\"tech-learning_practice_积分消费日志表数据迁移.md\":\"ZV_VSquq\",\"tech-learning_practice_网络连接相关问题排查.md\":\"lVJaX0Q0\",\"tech-learning_web3_北大肖臻《区块链技术与应用》_readme.md\":\"BRg90L9F\",\"tech-learning_web3_北大肖臻《区块链技术与应用》_笔记01-课程简介.md\":\"fUzJl1Ni\",\"tech-learning_web3_北大肖臻《区块链技术与应用》_笔记02-btc-密码学原理.md\":\"BUiPD7H4\",\"tech-learning_web3_北大肖臻《区块链技术与应用》_笔记03-btc-数据结构.md\":\"CPnbZdkJ\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"zh-CN\",\"dir\":\"ltr\",\"title\":\"kenstant的博客\",\"description\":\"kenstant的博客\",\"base\":\"/blogs/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[],\"sidebar\":[],\"aside\":true,\"search\":{\"provider\":\"local\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/kenstant\"}],\"footer\":{\"message\":\"我与我周旋久，宁做我\",\"copyright\":\"Copyright © 2025\"},\"editLink\":false,\"lastUpdatedText\":\"上次更新时间\",\"returnToTopLabel\":\"返回顶部\",\"appearance\":true,\"externalLinkIcon\":true},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false,\"additionalConfig\":{}}");</script>
    
  </body>
</html>